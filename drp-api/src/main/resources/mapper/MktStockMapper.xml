<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SQLSERVER_MktStock">
    <resultMap id="BaseResultMap" type="MktStock">
        <result column="storecode" jdbcType="CHAR" property="storecode"/>
        <result column="skucode" jdbcType="VARCHAR" property="skucode"/>
        <result column="quantity" jdbcType="INTEGER" property="quantity"/>
        <result column="ticktime" jdbcType="TIMESTAMP" property="lastUpdateTime"/>
        <result column="comtag" jdbcType="INTEGER" property="comtag"/>
        <result column="combatchno" jdbcType="VARCHAR" property="combatchno"/>
        <result column="num" jdbcType="NUMERIC" property="num"/>
    </resultMap>

    <sql id="tb">
        t_o2o_mkt_stock
    </sql>

    <sql id="cols_all">
        storecode, skucode, quantity,
      ticktime, comtag, combatchno, num
    </sql>

    <sql id="criteria">
    </sql>

    <select id="count" parameterType="map" resultType="long">
        SELECT COUNT(1)
        FROM
        <include refid="tb"/>
        <where>
            <include refid="criteria"/>
        </where>
    </select>

    <select id="paging" parameterType="map" resultMap="BaseResultMap">
        SELECT TOP ${pageSize}
        <include refid="cols_all"/>
        FROM
        (SELECT ROW_NUMBER() OVER (ORDER BY #{sort} DESC) AS RowNo,* FROM
        <include refid="tb"/>
        ) t
        <where>
            t.RowNo > #{offset}
            <include refid="criteria"/>
        </where>
    </select>
</mapper>